"use strict";const lodashEs=require("lodash-es"),utils_logger=require("./logger.cjs"),utils_childProcess=require("./childProcess.cjs"),{BUILD_PROJECT:g,BUILD_MODE:p,PROJECT_DIR:u,LOCAL_DEPLOY_DIR:i,LOCAL_DOWNLOAD_DIR:n,BASTION_SSH_HOST:A,BASTION_SSH_USER:d,BASTION_SSH_PASSWORD:f,BASTION_SSH_PORT:I,BASTION_SSH_PRIVATE_KEY:c,TARGET_SSH_HOST:T,TARGET_SSH_USER:S,TARGET_SSH_PASSWORD:_,TARGET_SSH_PORT:a,TARGET_SSH_PRIVATE_KEY:l,TARGET_BK_DIR:D,TARGET_DIR:H,TARGET_DIR_TEMP:s,TARGET_HEALTH_DIR:B,TARGET_HIDE_HEALTH_FILE_DIR:O,TARGET_HEALTH_FILE:P,TARGET_HEALTH_HIDDEN_FILE:L}=process.env;function getBastionConfig(e={}){return lodashEs.merge({host:A,port:I,username:d,password:f,privateKey:c},e)}function getBastionTargetConfig(e={}){return lodashEs.merge({host:T,port:a,username:S,password:_,privateKey:l,localDeployDir:i,localDownloadDir:n,remoteBackupDir:D,remoteDir:H,remoteDirTemp:s,remoteHealthDir:B,remoteHideHealthFileDir:O,remoteHealthFile:P,remoteHealthHiddenFile:L},e)}function getBastionChannelConfig(e={}){const o=getBastionTargetConfig(e);return lodashEs.merge({dstIP:o.host,dstPort:o.port},e)}function getWindowsServerTargetConfig(e={}){return lodashEs.merge({host:T,port:a,username:S,password:_,privateKey:l,localDeployDir:i,localDownloadDir:n,remoteBackupDir:D,remoteDir:H,remoteDirTemp:s},e)}function getBuildConfig(e){return lodashEs.merge({build:e.build||g==="true",mode:e.mode||p,projectDir:e.projectDir||u},e)}async function buildProject(e){const{mode:o,projectDir:r}=getBuildConfig(e),t=o?`build:${o}`:"build";utils_logger.logger.info("\u5F00\u59CB\u6253\u5305\u9879\u76EE...");const E=await utils_childProcess.execProjectPNPMCommand(r,t);return utils_logger.logger.info("\u6253\u5305\u9879\u76EE\u5B8C\u6210"),E}exports.buildProject=buildProject,exports.getBastionChannelConfig=getBastionChannelConfig,exports.getBastionConfig=getBastionConfig,exports.getBastionTargetConfig=getBastionTargetConfig,exports.getBuildConfig=getBuildConfig,exports.getWindowsServerTargetConfig=getWindowsServerTargetConfig;
