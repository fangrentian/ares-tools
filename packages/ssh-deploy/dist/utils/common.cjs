"use strict";const lodashEs=require("lodash-es"),utils_logger=require("./logger.cjs"),utils_childProcess=require("./childProcess.cjs"),{BUILD_PROJECT:E,BUILD_MODE:R,PROJECT_DIR:f,LOCAL_DEPLOY_DIR:i,LOCAL_DOWNLOAD_DIR:n,BASTION_SSH_HOST:u,BASTION_SSH_USER:A,BASTION_SSH_PASSWORD:d,BASTION_SSH_PORT:B,BASTION_SSH_PRIVATE_KEY:I,TARGET_SSH_HOST:S,TARGET_SSH_USER:T,TARGET_SSH_PASSWORD:a,TARGET_SSH_PORT:_,TARGET_SSH_PRIVATE_KEY:l,TARGET_BK_DIR:C,TARGET_DIR:D,TARGET_DIR_TEMP:H,TARGET_HEALTH_DIR:c,TARGET_HIDE_HEALTH_FILE_DIR:O,TARGET_HEALTH_FILE:P,TARGET_HEALTH_HIDDEN_FILE:L}=process.env;function getBastionConfig(e={}){return lodashEs.merge({host:u,port:B,username:A,password:d,privateKey:I},e)}function getBastionTargetConfig(e={}){return lodashEs.merge({host:S,port:_,username:T,password:a,privateKey:l,localDeployDir:i,localDownloadDir:n,remoteBackupDir:C,remoteDir:D,remoteDirTemp:H,remoteHealthDir:c,remoteHideHealthFileDir:O,remoteHealthFile:P,remoteHealthHiddenFile:L},e)}function getBastionChannelConfig(e={}){const o=getBastionTargetConfig(e);return lodashEs.merge({dstIP:o.host,dstPort:o.port},e)}function getWindowsServerTargetConfig(e={}){return lodashEs.merge({host:S,port:_,username:T,password:a,privateKey:l,localDeployDir:i,localDownloadDir:n,remoteBackupDir:C,remoteDir:D,remoteDirTemp:H},e)}function getBuildConfig(e){return lodashEs.merge({build:e.build||E==="true",mode:e.mode||R,projectDir:e.projectDir||f},e)}async function buildProject(e){const{mode:o,projectDir:r}=getBuildConfig(e),t=o?`build:${o}`:"build";utils_logger.logger.info("\u5F00\u59CB\u6253\u5305\u9879\u76EE...");const s=await utils_childProcess.execProjectPNPMCommand(r,t);return utils_logger.logger.info("\u6253\u5305\u9879\u76EE\u5B8C\u6210"),s}exports.buildProject=buildProject,exports.getBastionChannelConfig=getBastionChannelConfig,exports.getBastionConfig=getBastionConfig,exports.getBastionTargetConfig=getBastionTargetConfig,exports.getBuildConfig=getBuildConfig,exports.getWindowsServerTargetConfig=getWindowsServerTargetConfig;
