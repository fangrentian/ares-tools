import{merge as r}from"lodash-es";import{logger as t}from"./logger.mjs";import{execProjectPNPMCommand as c}from"./childProcess.mjs";const{BUILD_PROJECT:p,BUILD_MODE:I,PROJECT_DIR:d,LOCAL_DEPLOY_DIR:i,LOCAL_DOWNLOAD_DIR:T,BASTION_SSH_HOST:O,BASTION_SSH_USER:f,BASTION_SSH_PASSWORD:B,BASTION_SSH_PORT:P,BASTION_SSH_PRIVATE_KEY:g,TARGET_SSH_HOST:_,TARGET_SSH_USER:n,TARGET_SSH_PASSWORD:D,TARGET_SSH_PORT:u,TARGET_SSH_PRIVATE_KEY:E,TARGET_BK_DIR:S,TARGET_DIR:a,TARGET_DIR_TEMP:R,TARGET_HEALTH_DIR:L,TARGET_HIDE_HEALTH_FILE_DIR:C,TARGET_HEALTH_FILE:G,TARGET_HEALTH_HIDDEN_FILE:h}=process.env;function N(e={}){return r({host:O,port:P,username:f,password:B,privateKey:g},e)}function A(e={}){return r({host:_,port:u,username:n,password:D,privateKey:E,localDeployDir:i,localDownloadDir:T,remoteBackupDir:S,remoteDir:a,remoteDirTemp:R,remoteHealthDir:L,remoteHideHealthFileDir:C,remoteHealthFile:G,remoteHealthHiddenFile:h},e)}function w(e={}){const o=A(e);return r({dstIP:o.host,dstPort:o.port},e)}function F(e={}){return r({host:_,port:u,username:n,password:D,privateKey:E,localDeployDir:i,localDownloadDir:T,remoteBackupDir:S,remoteDir:a,remoteDirTemp:R},e)}function H(e){return r({build:e.build||p==="true",mode:e.mode||I,projectDir:e.projectDir||d},e)}async function y(e){const{mode:o,projectDir:l}=H(e),m=o?`build:${o}`:"build";t.info("\u5F00\u59CB\u6253\u5305\u9879\u76EE...");const s=await c(l,m);return t.info("\u6253\u5305\u9879\u76EE\u5B8C\u6210"),s}export{y as buildProject,w as getBastionChannelConfig,N as getBastionConfig,A as getBastionTargetConfig,H as getBuildConfig,F as getWindowsServerTargetConfig};
